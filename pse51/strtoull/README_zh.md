# strtoull — 将字符串转换为无符号长长整型

## 概要

```c
#include <stdlib.h>

unsigned long long strtoull(const char *str, char **endptr, int base);
```

## 描述

[CX] 本参考页描述的功能与 ISO C 标准保持一致。此处描述的要求与 ISO C 标准之间的任何冲突都是无意的。本卷 POSIX.1-2024 遵从 ISO C 标准。

这些函数应将 `str` 指向的字符串的初始部分分别转换为 **unsigned long** 和 **unsigned long long** 类型的表示。首先，它们将输入字符串分解为三个部分：

1. 一个初始的、可能为空的空白字节序列
2. 一个解释为主题序列的整数，该整数以由 `base` 值确定的某种基数表示
3. 一个由一个或多个无法识别的字符组成的最终字符串，包括输入字符串的终止 NUL 字符

然后它们应尝试将主题序列转换为无符号整数，并返回结果。

如果 `base` 的值为 0，主题序列的预期形式为十进制常量、八进制常量或十六进制常量，其中任何一种都可以前缀 '+' 或 '-' 符号。十进制常量以非零数字开头，由一系列十进制数字组成。八进制常量由前缀 '0' 组成，可选地后跟仅由 '0' 到 '7' 数字组成的序列。十六进制常量由前缀 0x 或 0X 组成，后跟十进制数字和字母 'a'（或 'A'）到 'f'（或 'F'）的序列，这些字母分别具有值 10 到 15。

如果 `base` 的值在 2 到 36 之间，主题序列的预期形式是表示由 `base` 指定基数的整数的字母和数字序列，可选地前缀 '+' 或 '-' 符号。从 'a'（或 'A'）到 'z'（或 'Z'）的字母被赋予值 10 到 35；只允许其赋值小于 `base` 值的字母。如果 `base` 的值为 16，字符 0x 或 0X 可选地可以在字母和数字序列之前，如果有符号的话跟在符号后面。

主题序列定义为输入字符串的最长初始子序列，从第一个非空白字节开始，具有预期形式。如果输入字符串为空或完全由空白字节组成，或者第一个非空白字节不是符号或允许的字母或数字，则主题序列应不包含任何字符。

如果主题序列具有预期形式且 `base` 的值为 0，从第一个数字开始的字符序列应被解释为整数常量。如果主题序列具有预期形式且 `base` 的值在 2 到 36 之间，它应被用作转换的基数，为每个字母赋予上述给定的值。如果主题序列以 <连字符减号> 开头，结果值应为转换值的负数；此操作应在返回类型中执行。指向最终字符串的指针应存储在 `endptr` 指向的对象中，前提是 `endptr` 不是空指针。

在 C [CX] 或 POSIX 语言环境之外，可以接受其他特定于语言环境的主题序列形式。

如果主题序列为空或不具有预期形式，则不执行转换；`str` 的值应存储在 `endptr` 指向的对象中，前提是 `endptr` 不是空指针。

如果成功，这些函数不应改变 `errno` 的设置。

由于错误时返回 0、{ULONG_MAX} 和 {ULLONG_MAX}，而这些值在成功时也是有效的返回值，希望检查错误情况的应用程序应将 `errno` 设置为 0，然后调用 `strtoul()` 或 `strtoull()`，然后检查 `errno`。

## 返回值

成功完成后，这些函数应返回转换后的值（如果有）。如果无法执行转换，应返回 0 [CX] 并可能将 `errno` 设置为 [EINVAL]。

[CX] 如果 `base` 的值不受支持，应返回 0 并将 `errno` 设置为 [EINVAL]。

如果正确值超出可表示值的范围，应返回 {ULONG_MAX} 或 {ULLONG_MAX} 并将 `errno` 设置为 [ERANGE]。

## 错误

`strtoull()` 函数应在以下情况失败：

- **[EINVAL]** — `base` 的值不受支持。

- **[ERANGE]** — 正确值超出可表示值的范围。

---

*以下部分为参考信息。*

## 示例

无。

## 应用程序用法

`strtoull()` 函数对于将无符号整数的字符串表示转换为其数值非常有用，具有适当的错误检查和各种进制数的处理。

## 原理

无。

## 未来方向

无。

## 另请参阅

- `strtoul()`
- `strtoimax()`
- `strtoumax()`
- `<stdlib.h>`

## 变更历史

首次发布于 Issue 1。源自 SVID 的 Issue 1。

### Issue 8

应用了 Austin Group Defect 1541，使功能与 ISO C 标准保持一致。

---
